<div md-swipe-right="prev()" md-swipe-left="next()">

  <div class="md-margin md-whiteframe-z1">
    <md-toolbar>
      <div class="md-toolbar-tools">
        <md-button class="md-icon-button" aria-label="Analyse précédente" ng-click="prev()" ng-disabled="!hasPrev()">
          <md-icon md-svg-icon="navigation:arrow_back"></md-icon>
        </md-button>

        <md-button ng-disabled="!analysis[index]" class="md-icon-button" aria-label="Liste des analyses" ng-click="back()">
          <md-icon md-svg-icon="action:list"></md-icon>
        </md-button>

        <md-button class="md-icon-button" aria-label="Analyse suivante" ng-click="next()" ng-disabled="!hasNext()">
          <md-icon md-svg-icon="navigation:arrow_forward"></md-icon>
        </md-button>

        <span flex></span>

        <md-button ng-disabled="!analysis[index].dirty" class="md-fab md-mini" aria-label="Sauvegarder l'analyse" ng-click="save(analysis[index])">
          <md-tooltip md-direction="bottom" md-autohide>Sauvegarder l'analyse</md-tooltip>
          <md-icon md-svg-icon="content:save"></md-icon>
        </md-button>

        <md-button ng-disabled="!analysis[index]" class="md-fab md-mini" aria-label="Supprimer l'analyse" ng-click="remove(analysis[index].id)">
          <md-tooltip md-direction="bottom" md-autohide>Supprimer l'analyse</md-tooltip>
          <md-icon md-svg-icon="action:delete"></md-icon>
        </md-button>

        <md-button class="md-fab md-mini" aria-label="Nouvelle analyse" ng-click="newAnalysis()">
          <md-tooltip md-direction="bottom" md-autohide>Nouvelle analyse</md-tooltip>
          <md-icon md-svg-icon="content:add"></md-icon>
        </md-button>
      </div>
    </md-toolbar>

    <md-content ng-hide="analysis[index]" class="whitesmoke md-padding">
      <md-list>
        <md-list-item ng-repeat="a in analysis track by $index">
          <button class="md-no-style md-button md-default-theme" ng-click="select($index)">
            <div class="md-list-item-text" ng-bind="a.title"></div>
          </button>
        </md-list-item>
      </md-list>
    </md-content>

    <md-content ng-if="analysis[index]" class="whitesmoke md-padding">
      <md-input-container>
        <label>Titre</label>
        <input type="text" ng-model="analysis[index].title" ng-change="setDirty(analysis[index].id)">
      </md-input-container>

      <div layout="row" layout-align="start center">
        <md-input-container flex>
          <label>URL</label>
          <input type="text" ng-model="analysis[index].url" ng-change="setDirty(analysis[index].id)">
        </md-input-container>

        <md-button class="md-icon-button" aria-label="Accéder à l'URL" ng-href="{{ analysis[index].url }}" ng-disabled="!analysis[index].url" target="_blank">
          <md-tooltip md-direction="bottom" md-autohide>Accéder à l'URL</md-tooltip>
          <md-icon md-svg-icon="action:launch"></md-icon>
        </md-button>
      </div>

      <div layout="row">
        <md-input-container flex="50">
          <label>Type</label>
          <md-select ng-model="analysis[index].rtype" ng-change="setDirty(analysis[index].id)">
            <md-option></md-option>
            <md-option value="article">Article</md-option>
            <md-option value="book">Book</md-option>
            <md-option value="book_section">Book section</md-option>
          </md-select>
        </md-input-container>

        <md-input-container flex="50">
          <label>Mime</label>
          <md-select ng-model="analysis[index].mime" ng-change="setDirty(analysis[index].id)">
            <md-option></md-option>
            <md-option value="pdf">PDF</md-option>
            <md-option value="html">HTML</md-option>
            <md-option value="misc">MISC</md-option>
          </md-select>
        </md-input-container>
      </div>

      <md-chips ng-model="analysis[index].identifiers" placeholder="Entrer un identifiant" delete-button-label="Supprimer l'identifiant" secondary-placeholder="Identifiants" ng-change="setDirty(analysis[index].id)"></md-chips>

      <md-input-container flex="50">
        <label>UnitID</label>
        <input type="text" ng-model="analysis[index].unitid" ng-change="setDirty(analysis[index].id)">
      </md-input-container>

      <md-input-container>
        <label>Remarques</label>
        <textarea ng-model="analysis[index].comment" ng-change="setDirty(analysis[index].id)"></textarea>
      </md-input-container>
    </md-content>
  </div>
</div>